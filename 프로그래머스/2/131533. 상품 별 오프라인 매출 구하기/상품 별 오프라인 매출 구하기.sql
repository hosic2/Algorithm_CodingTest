SELECT PRODUCT_CODE, b.PRICE * SUM(a.SALES_AMOUNT) AS SALES
FROM OFFLINE_SALE a
INNER JOIN PRODUCT b
ON a.PRODUCT_ID = b.PRODUCT_ID
GROUP BY b.PRODUCT_ID
ORDER BY SALES DESC, PRODUCT_CODE ASC;